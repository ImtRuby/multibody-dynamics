\documentclass{beamer}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                  Themes and such                         %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\mode<presentation>
{
  %\usetheme{Copenhagen}  
  %\usetheme{Warsaw}  
  \usetheme{Malmoe}  
%    \setbeamertemplate{headline}{}
  %make my huge toc fit on one slide (and not look horrible)
  %\setbeamerfont{subsection in toc}{series=\bfseries}
  %\setbeamerfont{subsection in toc}{size=\tiny,series=\bfseries}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                       Packages                           %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{multimedia}
\usepackage{multirow}
\usepackage{subfigure}
\usepackage{amsmath}

% Define commands
 \newcommand{\half}{\ensuremath{\frac{1}{2}}}

 \newcommand{\bea}{\begin{eqnarray}}
 \newcommand{\eea}{\end{eqnarray}}
 \newcommand{\beq}{\begin{equation}}
 \newcommand{\eeq}{\end{equation}}
 \newcommand{\bed}{\begin{displaymath}}
 \newcommand{\eed}{\end{displaymath}}

 \newcommand{\pd}[2]{\frac{\partial #1}{\partial #2}}
 \newcommand{\pf}[2]{\frac{d #1}{d #2}}
 \newcommand{\pdt}[2]{\frac{\partial^2 #1}{\partial #2^2}}
 \newcommand{\pft}[2]{\frac{d^2 #1}{d #2^2}}
 \newcommand{\pdtno}[2]{\frac{\partial^2 #1}{\partial #2}}
 \newcommand{\pdd}[3]{\frac{\partial^2 #1}{\partial #2 \partial #3}}
 \newcommand{\pff}[3]{\frac{d^2 #1}{d #2 d #3}}

 \graphicspath{{../figures/}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                     Title Info                           %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title[\hspace{-0.2cm} DIRK Adjoint]
{
Discrete Adjoint: Newmark--Beta--Gamma (NBG)
}

\author[Komahan Boopathy]
{
  \Large {Komahan Boopathy}\\
}

\institute
{
  \large Georgia Institute of Technology\\
 School of Aerospace Engineering\\
 Atlanta, GA
}

\date
{
\small \today
}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

%\begin{frame}
%  \frametitle{Outline}
%  \tableofcontents
%\end{frame}

\begin{frame}[allowframebreaks] \frametitle{Time Integration}

  The second--order governing differential equations are posed in the following
  descriptor form at the k-th time step:
  $$ R_k(\ddot{q}_k, \dot{q}_k, q_k, t_k , x) = 0.$$

  We use Newmark--Beta--Gamma (NBG) method to approximate the states:
  $$ \dot{q}_k  = \dot{q}_{k-1}  + (1-\gamma) h \ddot{q}_{k-1} +  \gamma h \ddot{q}_{k}$$ 
  $$ {q}_k      =     {q}_{k-1}  + h \dot{q}_{k-1} +\frac{1-2\beta}{2} h^2\ddot{q}_{k-1}+ \beta h^2 \ddot{q}_k.$$
  The acceleration states $\ddot{q}_k$ are the primary unknown at each time step.
  
  \framebreak

  The Lagrangian function is written as:

  $${\cal{L}} = \sum_{k=0}^N h f_k(\ddot{q}_k, \dot{q}_k, q_k) + \sum_{k=0}^N h  \lambda_k^T R_k(\ddot{q}_k, \dot{q}_k, q_k) $$

  Setting $\pd{\cal{L}}{\ddot{q}} = 0$ yields
  \small{
  $$ h\pd{f_k}{\ddot{q}_k}^T + h \pd{R_k}{\ddot{q}_k}^T \lambda_k
  + h\pd{f_{k-1}}{\ddot{q}_{k-1}}^T +  h \pd{R_{k-1}}{\ddot{q}_{k-1}}^T \lambda_{k-1} + \ldots + 
  h\pd{f_0}{\ddot{q}_0}^T + h \pd{R_0}{\ddot{q}_0}^T \lambda_0
  = 0 $$
  }

  The adjoint equation at each time step is:
  $$\pd{R_k}{\ddot{q}_k}^T \lambda_k = - \pd{f_k}{\ddot{q}_k}^T  - \pd{f_{k+1}}{\ddot{q}_{k}}^T - \pd{R_{k+1}}{\ddot{q}_{k}}^T \lambda_{k+1}.$$
  This can be written in expanded form as follows:
  \scriptsize{
  \begin{equation}\nonumber\begin{split}
    \left[ \pd{R_k}{\ddot{q}_k} + \gamma h \pd{R_k}{\dot{q}_k} + \beta h^2 \pd{R_k}{{q}_k} \right]^T \lambda_k & = \left\{ \pd{f_k}{\ddot{q}_k} + \gamma h \pd{f_k}{\dot{q}_k} + \beta h^2 \pd{f_k}{{q}_k} \right\}^T \\ & +  \left\{ \pd{R_{k+1}}{\ddot{q}_{k+1}} + (1-\gamma) h \pd{R_{k+1}}{\dot{q}_{k+1}} + \frac{1-2\beta}{2} h^2 \pd{R_{k+1}}{{q}_{k+1}} \right\}^T \\
    & +  \left[ \pd{R_{k+1}}{\ddot{q}_{k+1}} + (1-\gamma) h \pd{R_{k+1}}{\dot{q}_{k+1}} + \frac{1-2\beta}{2} h^2 \pd{R_{k+1}}{{q}_{k+1}} \right]^T\lambda_{k+1} \\
      \end{split}
  \end{equation}
  }
  
\end{frame}

\end{document}
